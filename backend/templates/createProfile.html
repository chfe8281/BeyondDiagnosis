<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MedConnect</title>
    <link href = "{{ url_for('static', filename='css/footer.css') }}" rel = "stylesheet">
</head>
<body>
    {% include "components/navbar.html" %}
    <p>Edit Profile</p>
    <form method="POST" enctype = "multipart/form-data">
        <input type="text-box" name="bio" placeholder="Bio" value = "{{ bio if bio else '' }}" required>
        <input type="text" name="location" placeholder="Location" value = "{{ location if location else '' }}" required>
        <input type="text" name="user_type" placeholder="Patient" value = "{{ status if status else '' }}" required>
        <div id = "interestInputs">
            {% if interests %}
                {% for interest in interests %}
                    <div id = "interest-group">
                        <input type="text" name="interests[]" value="{{ interest }}">
                        <button type="button" onclick="removeField(this)">Remove</button>
                    </div>
                {% endfor %}
                {% else %}
                    <input type="text" name="interests[]">
            {% endif %}
        </div>
        <button type="button" onclick="addTextInput(true)">Add More</button>
        <div id = "conditionInputs">
            {% if conditions %}
                {% for condition in conditions %}
                    <div id = "condition-group">
                        <input type="text" name="conditions[]" value="{{ condition }}">
                        <button type="button" onclick="removeField(this)">Remove</button>
                    </div>
                {% endfor %}
                {% else %}
                    <input type="text" name="conditions[]">
            {% endif %}
        </div>
        <button type="button" onclick="addTextInput(false)">Add More</button>
        <input type = "file" name = "avatar_file" accept = "image/*">
        {% if avatar_url %}
            <p>Current avatar:</p>
            <img src="{{ avatar_url }}" alt="Avatar" width="100" height="100">
        {% endif %}
        <button type="submit">Save Profile</button>
    </form>

    {% include "components/footer.html" %}
    <script>
        function addTextInput(interests) {
            var container;
            if(interests){
                container = document.getElementById('interestInputs')
            }
            else
            {
                container = document.getElementById('conditionInputs')
            }
            const input = document.createElement('input');
            input.type = 'text';
            if(interests){
                input.name = 'interests[]';
            }
            else
            {
                input.name = 'conditions[]';
            }
            container.appendChild(document.createElement('br'));
            container.appendChild(input);
        }
        function removeField(button){
            const group = button.parentElement;
            group.remove();
        }
    </script>
</body>
</html>